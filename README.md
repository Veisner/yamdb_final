https://github.com/Veisner/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg

# Проект YaMDb

REST API для сервиса YaMDb — база отзывов о фильмах, книгах и музыке.
Благодарные или возмущённые читатели оставляют к произведениям текстовые отзывы (Review) и выставляют произведению рейтинг.

## Ресурсы API YaMDb

**Отзывы:**
- получить список всех отзывов;
- создать новый отзыв;
- получить отзыв по id;
- частично обновить отзыв по id;
- удалить отзыв по id.

**Комментарии к отзывам:**
- Получить список всех комментариев к отзыву по id;
- создать новый комментарий для отзыва, получить комментарий для отзыва по id;
- частично обновить комментарий к отзыву по id;
- удалить комментарий к отзыву по id.

**JWT-токен:**
- Отправление confirmation_code на переданный email;
- получение JWT-токена в обмен на email и confirmation_code.

**Пользователи:**
- получить список всех пользователей;
- создание пользователя получить пользователя по username;
- изменить данные пользователя по username;
- удалить пользователя по username;
- получить данные своей учетной записи;
- изменить данные своей учетной записи.

**Категории (типы) произведений:**
- получить список всех категорий;
- создать категорию;
- удалить категорию.

**Категории жанров:**
- получить список всех жанров
- создать жанр;
- удалить жанр.

**Произведения, к которым пишут отзывы:**
- получить список всех объектов;
- создать произведение для отзывов;
- информация об объекте;
- обновить информацию об объекте;
- удалить произведение.

## Пользовательские роли

**Аноним** — может просматривать описания произведений, читать отзывы и комментарии.

**Аутентифицированный пользователь (user)** — может читать всё, как и Аноним, дополнительно может публиковать отзывы и ставить рейтинг произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы и ставить им оценки; может редактировать и удалять свои отзывы и комментарии.

**Модератор (moderator)** — те же права, что и у Аутентифицированного пользователя плюс право удалять и редактировать любые отзывы и комментарии.

**Администратор (admin)** — полные права на управление проектом и всем его содержимым. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.

**Суперпользователь** — те же права, что и у роли Администратор.

## Использование

Клонируем репозиторий.

Создаем .env и заполняем переменные окружения:
```
vim .env
SECRET_KEY=
DEBUG=
DJANGO_ALLOWED_HOSTS=
DEFAULT_FROM_EMAIL=

DB_ENGINE=
DB_NAME=
POSTGRES_USER=
POSTGRES_PASSWORD=
DB_HOST=
DB_PORT=
```

Собираем контейнеры и запускаем их:
```
docker-compose up -d --build
```

Выполняем миграции:
```
docker-compose exec web python manage.py migrate
```

Cобираем статику:
```
docker-compose exec web python manage.py collectstatic --no-input
```

Наполняем Postgres данными:
```
docker-compose exec web python3 manage.py loaddata fixtures.json
```

Cоздаём суперпользователя:
```
docker-compose exec web python manage.py createsuperuser
```

## Алгоритм регистрации пользователей

Пользователь отправляет запрос с параметрами email и username на /auth/signup/.

YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.

Пользователь отправляет запрос с параметрами username и confirmation_code на /auth/token/, 
в ответе на запрос ему приходит token (JWT-токен).


## Стек технологий:

Python3, Django 2, Django REST Framework, Postgresql, Simple JWT, Django Filter, Docker.


## Документация:

http://localhost/redoc/
